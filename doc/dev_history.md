# 開発履歴

## 2025-08-10: 履歴機能追加に向けた要件定義修正

### 実施内容

フロントエンドから履歴を渡し、バックエンドから回答と履歴の両方をJSONデータで返すように`doc/requirements.md`の要件定義を修正。

### 変更箇所

#### 1. API仕様（5. 外部仕様）

- **リクエスト**: `{"message":"文字列(1..8000)", "history":[{"role":"user"|"assistant","content":"文字列"}]}`
- **レスポンス**: `{"reply":"文字列(1..8000)", "history":[{"role":"user"|"assistant","content":"文字列"}]}`
- **OpenAPI定義**: リクエスト・レスポンス両方にhistory配列を追加

#### 2. 機能要件（7. 機能要件）

- **FR-1**: 「問いと履歴を受け、応答本文と更新された履歴を返す」に修正
- 履歴には会話の文脈が含まれ、新しい問いと回答が追加される仕様を明記

#### 3. 受入基準（9. 受入基準）

- **AC-1**: 「入力と履歴を送ると、応答本文と更新された履歴が返る」に修正

### 修正の意図

- チャットボットの会話継続性を実現
- フロントエンドで履歴管理を行い、バックエンドで文脈を考慮した応答生成
- API契約を明確化し、フロントエンド・バックエンド間のデータ交換仕様を統一

### 次のステップ

- バックエンド実装（FastAPI + LiteLLM）での履歴対応
- フロントエンド実装（React）での履歴管理機能
- 履歴機能を含む統合テスト実装
